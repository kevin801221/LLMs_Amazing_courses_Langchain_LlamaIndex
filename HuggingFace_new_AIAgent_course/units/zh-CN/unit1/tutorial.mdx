# ä½¿ç”¨ smolagents åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½ä½“

åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Python ä»£ç ä»å¤´å¼€å§‹åˆ›å»ºæ™ºèƒ½ä½“ï¼Œå¹¶ä¸”æˆ‘ä»¬**çœ‹åˆ°äº†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¤šä¹ˆç¹ç**ã€‚å¹¸è¿çš„æ˜¯ï¼Œè®¸å¤šæ™ºèƒ½ä½“åº“é€šè¿‡**ä¸ºä½ å¤„ç†å¤§é‡ç¹é‡çš„å·¥ä½œ**æ¥ç®€åŒ–è¿™é¡¹å·¥ä½œã€‚

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œ**ä½ å°†åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½ä½“**ï¼Œå®ƒèƒ½å¤Ÿæ‰§è¡Œå›¾åƒç”Ÿæˆã€ç½‘ç»œæœç´¢ã€æ—¶åŒºæ£€æŸ¥ç­‰æ›´å¤šæ“ä½œï¼

ä½ è¿˜å°†æŠŠä½ çš„æ™ºèƒ½ä½“**å‘å¸ƒåˆ° Hugging Face Space ä¸Šï¼Œä»¥ä¾¿ä¸æœ‹å‹å’ŒåŒäº‹åˆ†äº«**ã€‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼


## ä»€ä¹ˆæ˜¯ smolagentsï¼Ÿ

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/smolagents.png" alt="smolagents"/>

ä¸ºäº†åˆ›å»ºè¿™ä¸ªæ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ `smolagents`ï¼Œè¿™æ˜¯ä¸€ä¸ª**æä¾›è½»æ¾å¼€å‘æ™ºèƒ½ä½“æ¡†æ¶çš„åº“**ã€‚

è¿™ä¸ªè½»é‡çº§åº“è®¾è®¡ç®€æ´ï¼Œä½†å®ƒæŠ½è±¡äº†æ„å»ºæ™ºèƒ½ä½“çš„è®¸å¤šå¤æ‚æ€§ï¼Œä½¿ä½ èƒ½å¤Ÿä¸“æ³¨äºè®¾è®¡æ™ºèƒ½ä½“çš„è¡Œä¸ºã€‚

æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªå•å…ƒä¸­æ·±å…¥äº†è§£ smolagentsã€‚åŒæ—¶ï¼Œä½ ä¹Ÿå¯ä»¥æŸ¥çœ‹è¿™ç¯‡<a href="https://huggingface.co/blog/smolagents" target="_blank">åšå®¢æ–‡ç« </a>æˆ–è¯¥åº“çš„<a href="https://github.com/huggingface/smolagents" target="_blank">GitHub ä»“åº“</a>ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œ`smolagents` æ˜¯ä¸€ä¸ªä¸“æ³¨äº **codeAgent** çš„åº“ï¼ŒcodeAgent æ˜¯ä¸€ç§é€šè¿‡ä»£ç å—æ‰§è¡Œ**â€œæ“ä½œâ€**ï¼Œç„¶åé€šè¿‡æ‰§è¡Œä»£ç **â€œè§‚å¯Ÿâ€**ç»“æœçš„æ™ºèƒ½ä½“ã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä»¬å°†æ„å»ºçš„ä¸€ä¸ªç¤ºä¾‹ï¼

æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„æ™ºèƒ½ä½“æä¾›äº†ä¸€ä¸ª**å›¾åƒç”Ÿæˆå·¥å…·**ï¼Œå¹¶è¦æ±‚å®ƒç”Ÿæˆä¸€å¼ çŒ«çš„å›¾ç‰‡ã€‚

`smolagents` ä¸­çš„æ™ºèƒ½ä½“å°†å…·æœ‰**ä¸æˆ‘ä»¬ä¹‹å‰æ„å»ºçš„è‡ªå®šä¹‰æ™ºèƒ½ä½“ç›¸åŒçš„è¡Œä¸º**ï¼šå®ƒå°†**ä»¥å¾ªç¯çš„æ–¹å¼æ€è€ƒã€è¡ŒåŠ¨å’Œè§‚å¯Ÿ**ï¼Œç›´åˆ°å¾—å‡ºæœ€ç»ˆç­”æ¡ˆï¼š

[æ™ºèƒ½ä½“æµç¨‹](https://www.youtube.com/watch?v=PQDKcWiuln4)

å¾ˆä»¤äººå…´å¥‹ï¼Œå¯¹å§ï¼Ÿ

## è®©æˆ‘ä»¬æ¥æ„å»ºæˆ‘ä»¬çš„æ™ºèƒ½ä½“ï¼

é¦–å…ˆï¼Œå¤åˆ¶è¿™ä¸ª Spaceï¼š<a href="https://huggingface.co/spaces/agents-course/First_agent_template" target="_blank">https://huggingface.co/spaces/agents-course/First_agent_template</a>
> æ„Ÿè°¢ <a href="https://huggingface.co/m-ric" target="_blank">Aymeric</a> æä¾›çš„è¿™ä¸ªæ¨¡æ¿ï¼ğŸ™Œ

å¤åˆ¶è¿™ä¸ª Space æ„å‘³ç€**åœ¨ä½ çš„ä¸ªäººèµ„æ–™ä¸­åˆ›å»ºä¸€ä¸ªæœ¬åœ°å‰¯æœ¬**ï¼š
<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit1/duplicate-space.gif" alt="å¤åˆ¶"/>

åœ¨æ•´ä¸ªè¯¾ç¨‹ä¸­ï¼Œä½ å”¯ä¸€éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶æ˜¯å½“å‰ä¸å®Œæ•´çš„**"app.py"**ã€‚ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹[æ¨¡æ¿ä¸­çš„åŸå§‹æ–‡ä»¶](https://huggingface.co/spaces/agents-course/First_agent_template/blob/main/app.py)ã€‚è¦æ‰¾åˆ°ä½ çš„æ–‡ä»¶ï¼Œè¯·è¿›å…¥ä½ å¤åˆ¶çš„ Spaceï¼Œç„¶åç‚¹å‡» `Files` é€‰é¡¹å¡ï¼Œå†åœ¨ç›®å½•åˆ—è¡¨ä¸­ç‚¹å‡» `app.py`ã€‚

è®©æˆ‘ä»¬ä¸€èµ·åˆ†è§£ä»£ç ï¼š

- æ–‡ä»¶å¼€å¤´æ˜¯ä¸€äº›ç®€å•ä½†å¿…è¦çš„åº“å¯¼å…¥

```python
from smolagents import CodeAgent, DuckDuckGoSearchTool, HfApiModel, load_tool, tool
import datetime
import requests
import pytz
import yaml
from tools.final_answer import FinalAnswerTool
```

æ­£å¦‚ä¹‹å‰æ‰€è¿°ï¼Œæˆ‘ä»¬å°†ç›´æ¥ä½¿ç”¨ **smolagents** ä¸­çš„ **CodeAgent** ç±»ã€‚


### Toolï¼ˆå·¥å…·ï¼‰

ç°åœ¨è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹å·¥å…·ï¼å¦‚æœä½ éœ€è¦å›é¡¾ä¸€ä¸‹å·¥å…·çš„ç›¸å…³å†…å®¹ï¼Œè¯·éšæ—¶å›åˆ°è¯¾ç¨‹çš„[å·¥å…·](tools)éƒ¨åˆ†ã€‚

```python
@tool
def my_custom_tool(arg1:str, arg2:int)-> str: # it's important to specify the return type
    # Keep this format for the tool description / args description but feel free to modify the tool
    """A tool that does nothing yet 
    Args:
        arg1: the first argument
        arg2: the second argument
    """
    return "What magic will you build ?"

@tool
def get_current_time_in_timezone(timezone: str) -> str:
    """A tool that fetches the current local time in a specified timezone.
    Args:
        timezone: A string representing a valid timezone (e.g., 'America/New_York').
    """
    try:
        # Create timezone object
        tz = pytz.timezone(timezone)
        # Get current time in that timezone
        local_time = datetime.datetime.now(tz).strftime("%Y-%m-%d %H:%M:%S")
        return f"The current local time in {timezone} is: {local_time}"
    except Exception as e:
        return f"Error fetching time for timezone '{timezone}': {str(e)}"
```


è¿™äº›å·¥å…·æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸ªéƒ¨åˆ†é¼“åŠ±ä½ æ„å»ºçš„ä¸œè¥¿ï¼æˆ‘ä»¬ç»™ä½ ä¸¤ä¸ªä¾‹å­ï¼š

1. ä¸€ä¸ª**ä¸å·¥ä½œçš„è™šæ‹Ÿå·¥å…·**ï¼Œä½ å¯ä»¥ä¿®æ”¹å®ƒæ¥åˆ¶ä½œä¸€äº›æœ‰ç”¨çš„ä¸œè¥¿ã€‚
2. ä¸€ä¸ª**å®é™…å·¥ä½œçš„å·¥å…·**ï¼Œå®ƒå¯ä»¥è·å–ä¸–ç•ŒæŸåœ°çš„å½“å‰æ—¶é—´ã€‚

è¦å®šä¹‰ä½ çš„å·¥å…·ï¼Œé‡è¦çš„æ˜¯ï¼š

1. ä¸ºä½ çš„å‡½æ•°æä¾›è¾“å…¥å’Œè¾“å‡ºç±»å‹ï¼Œä¾‹å¦‚ `get_current_time_in_timezone(timezone: str) -> str:`
2. **æ ¼å¼è‰¯å¥½çš„æ–‡æ¡£å­—ç¬¦ä¸²**ã€‚`smolagents` æœŸæœ›æ‰€æœ‰å‚æ•°åœ¨æ–‡æ¡£å­—ç¬¦ä¸²ä¸­éƒ½æœ‰**æ–‡å­—æè¿°**ã€‚

### The Agentï¼ˆæ™ºèƒ½ä½“ï¼‰

å®ƒä½¿ç”¨ [`Qwen/Qwen2.5-Coder-32B-Instruct`](https://huggingface.co/Qwen/Qwen2.5-Coder-32B-Instruct) ä½œä¸º LLM å¼•æ“ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ— æœåŠ¡å™¨ API è®¿é—®å®ƒã€‚

```python
final_answer = FinalAnswerTool()
model = HfApiModel(
    max_tokens=2096,
    temperature=0.5,
    model_id='Qwen/Qwen2.5-Coder-32B-Instruct',
    custom_role_conversions=None,
)

with open("prompts.yaml", 'r') as stream:
    prompt_templates = yaml.safe_load(stream)
    
# We're creating our CodeAgent
agent = CodeAgent(
    model=model,
    tools=[final_answer], # add your tools here (don't remove final_answer)
    max_steps=6,
    verbosity_level=1,
    grammar=None,
    planning_interval=None,
    name=None,
    description=None,
    prompt_templates=prompt_templates
)

GradioUI(agent).launch()
```

è¿™ä¸ªæ™ºèƒ½ä½“ä»åœ¨ä½¿ç”¨æˆ‘ä»¬åœ¨å‰é¢éƒ¨åˆ†ä¸­çœ‹åˆ°çš„`InferenceClient`ï¼Œå®ƒä½äº**HfApiModel**ç±»çš„èƒŒåï¼

å½“æˆ‘ä»¬ä»‹ç» Unit 2 ä¸­çš„æ¡†æ¶æ—¶ï¼Œæˆ‘ä»¬ä¼šç»™å‡ºæ›´æ·±å…¥çš„ä¾‹å­ã€‚ç›®å‰ï¼Œä½ éœ€è¦ä¸“æ³¨äºé€šè¿‡æ™ºèƒ½ä½“çš„`tools`å‚æ•°**å‘å·¥å…·åˆ—è¡¨ä¸­æ·»åŠ æ–°å·¥å…·**ã€‚

ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»£ç ç¬¬ä¸€è¡Œå¯¼å…¥çš„`DuckDuckGoSearchTool`ï¼Œæˆ–è€…ä½ å¯ä»¥æ£€æŸ¥ç¨åä» Hub åŠ è½½çš„`image_generation_tool`ã€‚

**æ·»åŠ å·¥å…·å°†èµ‹äºˆä½ çš„æ™ºèƒ½ä½“æ–°çš„èƒ½åŠ›**ï¼Œåœ¨è¿™é‡Œå°è¯•å‘æŒ¥åˆ›æ„å§ï¼

å®Œæ•´çš„"app.py"ï¼š

```python
from smolagents import CodeAgent, DuckDuckGoSearchTool, HfApiModel, load_tool, tool
import datetime
import requests
import pytz
import yaml
from tools.final_answer import FinalAnswerTool

from Gradio_UI import GradioUI

# Below is an example of a tool that does nothing. Amaze us with your creativity!
@tool
def my_custom_tool(arg1:str, arg2:int)-> str: # it's important to specify the return type
    # Keep this format for the tool description / args description but feel free to modify the tool
    """A tool that does nothing yet 
    Args:
        arg1: the first argument
        arg2: the second argument
    """
    return "What magic will you build ?"

@tool
def get_current_time_in_timezone(timezone: str) -> str:
    """A tool that fetches the current local time in a specified timezone.
    Args:
        timezone: A string representing a valid timezone (e.g., 'America/New_York').
    """
    try:
        # Create timezone object
        tz = pytz.timezone(timezone)
        # Get current time in that timezone
        local_time = datetime.datetime.now(tz).strftime("%Y-%m-%d %H:%M:%S")
        return f"The current local time in {timezone} is: {local_time}"
    except Exception as e:
        return f"Error fetching time for timezone '{timezone}': {str(e)}"


final_answer = FinalAnswerTool()
model = HfApiModel(
max_tokens=2096,
temperature=0.5,
model_id='Qwen/Qwen2.5-Coder-32B-Instruct',
custom_role_conversions=None,
)


# Import tool from Hub
image_generation_tool = load_tool("agents-course/text-to-image", trust_remote_code=True)

with open("prompts.yaml", 'r') as stream:
    prompt_templates = yaml.safe_load(stream)
    
agent = CodeAgent(
    model=model,
    tools=[final_answer], # add your tools here (don't remove final_answer)
    max_steps=6,
    verbosity_level=1,
    grammar=None,
    planning_interval=None,
    name=None,
    description=None,
    prompt_templates=prompt_templates
)


GradioUI(agent).launch()
```

ä½ çš„**ç›®æ ‡**æ˜¯ç†Ÿæ‚‰ Space å’Œæ™ºèƒ½ä½“ã€‚

ç›®å‰ï¼Œæ¨¡æ¿ä¸­çš„æ™ºèƒ½ä½“**æ²¡æœ‰ä½¿ç”¨ä»»ä½•å·¥å…·ï¼Œæ‰€ä»¥å°è¯•ä¸ºå®ƒæä¾›ä¸€äº›é¢„åˆ¶çš„å·¥å…·ï¼Œç”šè‡³è‡ªå·±åŠ¨æ‰‹åˆ¶ä½œä¸€äº›æ–°å·¥å…·ï¼**

æˆ‘ä»¬éå¸¸æœŸå¾…åœ¨ Discord é¢‘é“ **#agents-course-showcase** ä¸­çœ‹åˆ°ä½ çš„ç²¾å½©æ™ºèƒ½ä½“æˆæœï¼


---
æ­å–œä½ ï¼Œä½ å·²ç»æ„å»ºäº†ä½ çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½ä½“ï¼ä¸è¦çŠ¹è±«ï¼Œä¸ä½ çš„æœ‹å‹å’ŒåŒäº‹åˆ†äº«å§ã€‚

ç”±äºè¿™æ˜¯ä½ çš„ç¬¬ä¸€æ¬¡å°è¯•ï¼Œå¦‚æœæœ‰ç‚¹å°é—®é¢˜æˆ–é€Ÿåº¦æœ‰ç‚¹æ…¢ï¼Œè¿™æ˜¯å®Œå…¨æ­£å¸¸çš„ã€‚åœ¨æœªæ¥çš„å•å…ƒä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•æ„å»ºæ›´å¥½çš„æ™ºèƒ½ä½“ã€‚

æœ€å¥½çš„å­¦ä¹ æ–¹æ³•æ˜¯å°è¯•ï¼Œæ‰€ä»¥ä¸è¦çŠ¹è±«ï¼Œå»æ›´æ–°å®ƒï¼Œæ·»åŠ æ›´å¤šå·¥å…·ï¼Œå°è¯•ä½¿ç”¨å¦ä¸€ä¸ªæ¨¡å‹ï¼Œç­‰ç­‰ã€‚

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œä½ å°†å®Œæˆæœ€åçš„æµ‹éªŒå¹¶è·å¾—è¯ä¹¦ï¼

